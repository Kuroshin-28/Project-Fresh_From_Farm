SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
SET time_zone = "+00:00";

-- MySQL Script generated by MySQL Workbench
-- Tue Jul 18 17:27:15 2023
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema fresh_from_farm
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `fresh_from_farm` ;

-- -----------------------------------------------------
-- Schema fresh_from_farm
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `fresh_from_farm` DEFAULT CHARACTER SET utf8 ;
USE `fresh_from_farm` ;

-- -----------------------------------------------------
-- Table `fresh_from_farm`.`command`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `fresh_from_farm`.`command` ;

CREATE TABLE IF NOT EXISTS `fresh_from_farm`.`command` (
  `ID` VARCHAR(255) NOT NULL,
  `userID` INT NULL,
  `deleted_user_firstname` VARCHAR(80) NULL DEFAULT NULL,
  `deleted_user_lastname` VARCHAR(80) NULL DEFAULT NULL,
  `producerID` INT NULL,
  `deleted_producer_firstname` VARCHAR(80) NULL DEFAULT NULL,
  `deleted_producer_lastname` VARCHAR(80) NULL DEFAULT NULL,
  `date` DATE NOT NULL,
  `status` ENUM("Requested", "In process", "Ready for pick up", "Done", "Cancelled") NOT NULL DEFAULT '\"Requested\"',
  PRIMARY KEY (`ID`),
  INDEX `fk_commande_utilisateur1_idx` (`userID` ASC) VISIBLE,
  INDEX `fk_commande_producteur1_idx` (`producerID` ASC) VISIBLE,
  CONSTRAINT `fk_commande_utilisateur1`
    FOREIGN KEY (`userID`)
    REFERENCES `fresh_from_farm`.`user` (`ID`)
    ON DELETE SET NULL
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_commande_producteur1`
    FOREIGN KEY (`producerID`)
    REFERENCES `fresh_from_farm`.`producer` (`producerID`)
    ON DELETE SET NULL
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `fresh_from_farm`.`commandElement`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `fresh_from_farm`.`commandElement` ;

CREATE TABLE IF NOT EXISTS `fresh_from_farm`.`commandElement` (
  `ID` VARCHAR(255) NOT NULL,
  `commandeID` VARCHAR(255) NOT NULL,
  `productName` VARCHAR(80) NOT NULL,
  `productPrice` FLOAT NOT NULL,
  `productQuantity` VARCHAR(10) NOT NULL,
  PRIMARY KEY (`ID`),
  CONSTRAINT `fk_command_commandElement`
    FOREIGN KEY (`ID`)
    REFERENCES `fresh_from_farm`.`command` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `fresh_from_farm`.`department`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `fresh_from_farm`.`department` ;

CREATE TABLE IF NOT EXISTS `fresh_from_farm`.`department` (
  `ID` INT NOT NULL,
  `name` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `name_UNIQUE` (`name` ASC) VISIBLE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `fresh_from_farm`.`producer`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `fresh_from_farm`.`producer` ;

CREATE TABLE IF NOT EXISTS `fresh_from_farm`.`producer` (
  `producerID` INT NOT NULL,
  `isSelling` TINYINT NOT NULL DEFAULT 0,
  PRIMARY KEY (`producerID`),
  CONSTRAINT `fk_producteur_utilisateur1`
    FOREIGN KEY (`producerID`)
    REFERENCES `fresh_from_farm`.`user` (`ID`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `fresh_from_farm`.`product`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `fresh_from_farm`.`product` ;

CREATE TABLE IF NOT EXISTS `fresh_from_farm`.`product` (
  `ID` INT NOT NULL,
  `productInfoID` INT NOT NULL,
  `price` FLOAT NOT NULL,
  `quantity` ENUM("unitaire", "kg", "g") NOT NULL DEFAULT '\"kg\"',
  PRIMARY KEY (`ID`),
  INDEX `fk_produit_productInfo1_idx` (`productInfoID` ASC) VISIBLE,
  CONSTRAINT `fk_product_productInfo`
    FOREIGN KEY (`productInfoID`)
    REFERENCES `fresh_from_farm`.`productInfo` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_product_producer`
    FOREIGN KEY (`ID`)
    REFERENCES `fresh_from_farm`.`producer` (`producerID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `fresh_from_farm`.`productInfo`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `fresh_from_farm`.`productInfo` ;

CREATE TABLE IF NOT EXISTS `fresh_from_farm`.`productInfo` (
  `ID` INT NOT NULL,
  `name` VARCHAR(80) NOT NULL,
  `image` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`ID`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `fresh_from_farm`.`region`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `fresh_from_farm`.`region` ;

CREATE TABLE IF NOT EXISTS `fresh_from_farm`.`region` (
  `ID` INT NOT NULL,
  `name` VARCHAR(100) NOT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `name_UNIQUE` (`name` ASC) VISIBLE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `fresh_from_farm`.`user`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `fresh_from_farm`.`user` ;

CREATE TABLE IF NOT EXISTS `fresh_from_farm`.`user` (
  `ID` INT NOT NULL AUTO_INCREMENT,
  `firstname` VARCHAR(80) NOT NULL,
  `lastname` VARCHAR(80) NOT NULL,
  `mail` VARCHAR(255) NOT NULL,
  `phone` VARCHAR(20) NULL,
  `password` VARCHAR(255) NOT NULL,
  `regionID` INT NULL,
  `departmentID` INT NULL,
  `city` VARCHAR(80) NOT NULL,
  `address` VARCHAR(255) NOT NULL,
  `role` ENUM("client", "producteur") NOT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `ID_UNIQUE` (`ID` ASC) VISIBLE,
  INDEX `fk_utilisateur_région1_idx` (`regionID` ASC) VISIBLE,
  INDEX `fk_utilisateur_département1_idx` (`departmentID` ASC) VISIBLE,
  CONSTRAINT `fk_utilisateur_région1`
    FOREIGN KEY (`regionID`)
    REFERENCES `fresh_from_farm`.`region` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_utilisateur_département1`
    FOREIGN KEY (`departmentID`)
    REFERENCES `fresh_from_farm`.`department` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
